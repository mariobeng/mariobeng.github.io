<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" name="viewport">
    <title>联系客服</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css" />
    <link rel="stylesheet" type="text/css" href="css/help.css" />
</head>

<body>
    <main role="main">
        <div class="container-divider"></div>
        <div class="container">
            <div class="form">
                <div class="form-field string required">
                    <label for="email">邮箱地址</label>
                    <input type="email" name="" id="email" placeholder="请输入邮箱地址">
                </div>
                <div class="form-field string  required">
                    <label for="tel">手机号码</label>
                    <input type="text" name="" id="tel" placeholder="请输入手机号">
                </div>
                <div class="form-field string required">
                    <label for="subject">标题</label>
                    <input type="text" name="" id="subject" placeholder="请输入标题">
                </div>
                <div class="form-field text required">
                    <label for="description">描述</label>
                    <textarea rows="5" name="" id="description" placeholder="请输入问题描述"></textarea>
                </div>
                <footer><input id="submit" type="button" name="commit" value="提 交"></footer>
            </div>
        </div>
    </main>
    <script type="text/javascript" src="js/jquery-1.10.1.min.js"></script>
    <script src="js/layer_mobile/layer.js"></script>
    <script type="text/javascript" src="js/url.js"></script>
    <script>
        /*提交表单*/
        function send_info() {
            var email = $("#email").val();
            var phone = $("#tel").val();
            var title = $("#subject").val();
            var content = $("#description").val();

            if (!(/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/.test(email))) {
                layer.open({
                    content: '请填写有效的邮箱',
                    btn: '确定'
                });
                return false;
            }
            if (!(/^1(3|4|5|7|8|9)\d{9}$/.test(phone))) {
                layer.open({
                    content: '请填写有效的手机号码',
                    btn: '确定'
                });
                return false;
            }
            if (title == "") {
                layer.open({
                    content: '请填写标题',
                    btn: '确定'
                });
                return false;
            }
            if (content == "") {
                layer.open({
                    content: '请填写问题描述',
                    btn: '确定'
                });
                return false;
            }
            submitInfo();
        }

        function submitInfo() {
            layer.open({
                type: 2,
                content: '正在提交'
            });
            var email = $("#email").val();
            var phone = $("#tel").val();
            var title = $("#subject").val();
            var content = $("#description").val();

            var data = {
                email: email,
                phone: phone,
                title: title,
                content: content
            };
            $.ajax({
                url: url + '/customer/callCustomer',
                type: "post",
                dataType: "json",
                data: data,
                success: function(res) {
                    console.log(res);
                    if (res.data) {
                        layer.open({
                            content: '提交成功',
                            btn: '确定',
                            yes: function(index) {
                                $("#email").val("");
                                $("#tel").val("");
                                $("#subject").val("");
                                $("#description").val("");
                                layer.closeAll();
                            }
                        });
                    } else {
                        layer.open({
                            content: res.message,
                            btn: '确定'
                        });
                    }
                },
                error: function(xhr) {
                    console.log("Error: " + xhr);
                }
            });
        }
        $("#submit").click(function() {
            send_info();
        })
    </script>
</body>

</html>
